language: bash

templates:
  windows: &windows
    os: windows
    before_script:
      - export PATH="/c/Program Files/CMake/bin":$PATH
  linux: &linux
    os: linux
  osx: &osx
    os: osx

matrix:  
  include:      
    - name: Windows - MSVC - x64
      <<: *windows
      env: 
        - CMAKE_BUILD_TYPE=Release
        - CMAKE_GENERATOR="Visual Studio 15 2017 Win64"

    - name: Windows - MSVC - x86
      <<: *windows
      env: 
        - CMAKE_BUILD_TYPE=Release
        - CMAKE_GENERATOR="Visual Studio 15 2017"

    - name: Linux - GCC4.9 - x64
      <<: *linux
      addons:
        apt:
          sources:
            - ubuntu-toolchain-r-test
          packages:
            - g++-4.9
            - gcc-4.9
      env:
        - CC=gcc-4.9
        - CXX=g++-4.9
        - CMAKE_BUILD_TYPE=Release
        - CMAKE_GENERATOR="Unix Makefiles"


    - name: Linux - GCC - x64
      <<: *linux
      env:
        - CC=gcc
        - CXX=g++
        - CMAKE_BUILD_TYPE=Release
        - CMAKE_GENERATOR="Unix Makefiles"

    - name: Linux - Clang - x64
      <<: *linux
      env:
        - CC=clang
        - CXX=clang++
        - CMAKE_BUILD_TYPE=Release
        - CMAKE_GENERATOR="Unix Makefiles"

    - name: OS-X - Clang - x64
      <<: *osx
      env:
        - CMAKE_BUILD_TYPE=Release
        - CMAKE_GENERATOR="Unix Makefiles"

script:
  - mkdir -p build
  - cd build  
  - cmake -G "${CMAKE_GENERATOR}" -DCMAKE_BUILD_TYPE=${CMAKE_BUILD_TYPE} ..
  - cmake --build .
  - ctest --output-on-failure

notifications:
  email: false